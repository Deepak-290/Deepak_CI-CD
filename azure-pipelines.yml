# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml
trigger: none
pr: none

pool:
  name: My_Local_Agent

steps:
- checkout: none

- script: |
    REM === Create folders ===
    if not exist "C:\temp\tcLogs" mkdir "C:\temp\tcLogs"
    if not exist "$(Build.ArtifactStagingDirectory)" mkdir "$(Build.ArtifactStagingDirectory)"

    REM === Run TestComplete and export log ===
    "C:\Program Files (x86)\SmartBear\TestComplete 15\x64\Bin\TestComplete.exe" "C:\Users\deepak.mangalagatti\Downloads\Project-1\Project-1.pjs" /run /project:Project-1 /test:"KeywordTests|Test1" /ExportLog:"C:\temp\tcLogs\TestCompleteLog.mht" /SilentMode /Exit

    REM === Copy log to Azure staging directory ===
    copy /Y "C:\temp\tcLogs\TestCompleteLog.mht" "$(Build.ArtifactStagingDirectory)\"
  displayName: "Run TestComplete and collect log"

- task: PublishPipelineArtifact@1
  displayName: "Publish TestComplete Log"
  inputs:
    targetPath: "$(Build.ArtifactStagingDirectory)"
    artifact: "TestComplete_Logs"
    publishLocation: "pipeline"













